{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="group-container">
  <h1>Group Name: {{ group.name }}</h1>
  <h2>Country: {{ group.country }}</h2>
  <h3>Founded: {{ group.founding_year }}</h3>
  <p>Description: {{ group.description }}</p>

  <div class="group-actions">
    {% comment %} <a href="{% url 'group-index' %}" class="btn">All Groups</a> {% endcomment %}
    <a href="{% url 'group-update' group.id %}" class="btn warn">Edit</a>
    <a href="{% url 'group-delete' group.id %}" class="btn danger">Delete</a>
  </div>

  <h2>Tifos</h2>

  <h3><a href="{% url 'tifo-create' group.id %}" class="btn btn-success">Add Tifo</a></h3>
  {% comment %} <a href="{% url 'tifo-create' group.id %}" class="btn btn-success">Add Tifo on Separate Page</a> {% endcomment %}
  {% comment %} <!-- Inline Tifo form -->
   <form action="{% url 'tifo-create' group.id %}" method="post" enctype="multipart/form-data" autocomplete="off">
    {% csrf_token %}
    {{ tifo_form.as_p }}
    <button type="submit" class="btn submit">Add Tifo</button>
  </form> {% endcomment %}

<h3>Past Tifos</h3>
{% if group.tifo_set.exists %}
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Description</th>
        <th>Picture</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for tifo in group.tifo_set.all %}
      <tr>
        <td>{{ tifo.date }}</td>
        <td>{{ tifo.get_tifo_type_display }}</td>
        <td>{{ tifo.description }}</td>
        <td>
          {% if tifo.picture %}
            <img src="{{ tifo.picture.url }}" alt="Tifo image" style="max-width:150px; max-height:150px;">
          {% else %}
            No image
          {% endif %}
        </td>
        <td>
          {% if tifo.user == request.user %}
            <a href="{% url 'tifo-edit' tifo.id %}" class="btn">Edit</a> |
            <a href="{% url 'tifo-delete' tifo.id %}" class="btn danger">Delete</a>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>⚠️ This group has not created any tifos yet.</p>
{% endif %}

</section>
{% endblock %}
